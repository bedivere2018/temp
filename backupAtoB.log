config:backup5.yaml
[2023/05/05 09:04:25.727 +00:00] [INFO] [logutil/logutil.go:165] ["Log directory"] [configDir=]
[2023/05/05 09:04:25.727 +00:00] [INFO] [logutil/logutil.go:166] ["Set log file to "] [path=logs/backup.log]
[2023/05/05 09:04:25.728 +00:00] [INFO] [core/backup_context.go:154] ["receive CreateBackupRequest"] [requestId=d5894bde-eb23-11ed-83e5-0242ac1e0103] [backupName=test_backup_110to122_debug] [collections="[tb_src_category]"] [async=false]
[2023/05/05 09:04:25.728 +00:00] [DEBUG] [core/backup_context.go:64] ["Start Milvus client"] [endpoint=192.168.3.110:19530]
[2023/05/05 09:04:25.730 +00:00] [DEBUG] [core/backup_context.go:88] ["Start minio client"] [address=192.168.10.122:9000] [bucket=a-bucket] [backupBucket=a-bucket]
[2023/05/05 09:04:25.733 +00:00] [INFO] [storage/minio_chunk_manager.go:112] ["minio chunk manager init success."] [bucketname=a-bucket] [root=files]
[2023/05/05 09:04:25.797 +00:00] [DEBUG] [core/backup_context.go:287] ["Request collection names"] [request_collection_names="[tb_src_category]"] [length=1]
[2023/05/05 09:04:25.812 +00:00] [INFO] [core/backup_context.go:321] ["collections to backup"] [collections="[{\"ID\":441111237232208082,\"Name\":\"tb_src_category\",\"Schema\":{\"CollectionName\":\"tb_src_category\",\"Description\":\"tb_src_category demo collection\",\"AutoID\":false,\"Fields\":[{\"ID\":100,\"Name\":\"key\",\"PrimaryKey\":true,\"AutoID\":false,\"Description\":\"\",\"DataType\":21,\"TypeParams\":{\"max_length\":\"32\"},\"IndexParams\":{}},{\"ID\":101,\"Name\":\"shop_id\",\"PrimaryKey\":false,\"AutoID\":false,\"Description\":\"\",\"DataType\":21,\"TypeParams\":{\"max_length\":\"16\"},\"IndexParams\":{}},{\"ID\":102,\"Name\":\"shop_name\",\"PrimaryKey\":false,\"AutoID\":false,\"Description\":\"\",\"DataType\":21,\"TypeParams\":{\"max_length\":\"32\"},\"IndexParams\":{}},{\"ID\":103,\"Name\":\"cat_id\",\"PrimaryKey\":false,\"AutoID\":false,\"Description\":\"\",\"DataType\":21,\"TypeParams\":{\"max_length\":\"16\"},\"IndexParams\":{}},{\"ID\":104,\"Name\":\"cat_name\",\"PrimaryKey\":false,\"AutoID\":false,\"Description\":\"\",\"DataType\":21,\"TypeParams\":{\"max_length\":\"1000\"},\"IndexParams\":{}},{\"ID\":105,\"Name\":\"embedding\",\"PrimaryKey\":false,\"AutoID\":false,\"Description\":\"\",\"DataType\":101,\"TypeParams\":{\"dim\":\"1536\"},\"IndexParams\":{}}]},\"PhysicalChannels\":[\"by-dev-rootcoord-dml_4\",\"by-dev-rootcoord-dml_5\"],\"VirtualChannels\":[\"by-dev-rootcoord-dml_4_441111237232208082v0\",\"by-dev-rootcoord-dml_5_441111237232208082v1\"],\"Loaded\":false,\"ConsistencyLevel\":0,\"ShardNum\":2}]"]
[2023/05/05 09:04:25.814 +00:00] [INFO] [core/backup_context.go:355] ["try to get index"] [collection_name=tb_src_category]
[2023/05/05 09:04:25.826 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=key] ["index info"="[{}]"]
[2023/05/05 09:04:25.832 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=shop_id] ["index info"="[{}]"]
[2023/05/05 09:04:25.839 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=shop_name] ["index info"="[{}]"]
[2023/05/05 09:04:25.845 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=cat_id] ["index info"="[{}]"]
[2023/05/05 09:04:25.852 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=cat_name] ["index info"="[{}]"]
[2023/05/05 09:04:25.858 +00:00] [INFO] [core/backup_context.go:375] ["field index"] [collection_name=tb_src_category] [field_name=embedding] ["index info"="[{}]"]
[2023/05/05 09:04:25.858 +00:00] [DEBUG] [core/backup_context.go:269] ["call refreshBackupMetaFunc"] [id=d58aefd7-eb23-11ed-83e5-0242ac1e0103]
[2023/05/05 09:04:25.892 +00:00] [INFO] [core/backup_context.go:468] ["GetPersistentSegmentInfo before flush from milvus"] [collectionName=tb_src_category] [segmentNumBeforeFlush=4]
[2023/05/05 09:04:25.896 +00:00] [INFO] [core/backup_context.go:477] ["flush segments"] [collectionName=tb_src_category] [newSealedSegmentIDs="[]"] [flushedSegmentIDs="[441224472928550532,441224472928550533,441224472928550688,441224472928550690]"] [timeOfSeal=1683277465]
[2023/05/05 09:04:25.899 +00:00] [INFO] [core/backup_context.go:490] ["GetPersistentSegmentInfo after flush from milvus"] [collectionName=tb_src_category] [segmentNumBeforeFlush=4] [segmentNumAfterFlush=4]
[2023/05/05 09:04:25.899 +00:00] [WARN] [core/backup_context.go:513] ["this may be old segments before flush, skip it"] [id=441224472928550688]
[2023/05/05 09:04:25.899 +00:00] [WARN] [core/backup_context.go:513] ["this may be old segments before flush, skip it"] [id=441224472928550690]
[2023/05/05 09:04:25.899 +00:00] [WARN] [core/backup_context.go:513] ["this may be old segments before flush, skip it"] [id=441224472928550532]
[2023/05/05 09:04:25.899 +00:00] [WARN] [core/backup_context.go:513] ["this may be old segments before flush, skip it"] [id=441224472928550533]
[2023/05/05 09:04:25.899 +00:00] [INFO] [core/backup_context.go:527] ["Finished fill segment"] [collectionName=tb_src_category]
[2023/05/05 09:04:25.900 +00:00] [DEBUG] [core/backup_context.go:1561] [insertPath] [insertPath=files/insert_log/441111237232208082/441111237232208083/441224472928550532/]
[2023/05/05 09:04:25.902 +00:00] [DEBUG] [core/backup_context.go:1563] [fieldsLogDir] [fieldsLogDir="[]"]
[2023/05/05 09:04:25.903 +00:00] [WARN] [core/backup_context.go:538] ["this segment has no insert binlog"] [id=441224472928550532]
[2023/05/05 09:04:25.904 +00:00] [DEBUG] [core/backup_context.go:1561] [insertPath] [insertPath=files/insert_log/441111237232208082/441111237232208083/441224472928550533/]
[2023/05/05 09:04:25.905 +00:00] [DEBUG] [core/backup_context.go:1563] [fieldsLogDir] [fieldsLogDir="[]"]
[2023/05/05 09:04:25.907 +00:00] [WARN] [core/backup_context.go:538] ["this segment has no insert binlog"] [id=441224472928550533]
[2023/05/05 09:04:25.907 +00:00] [DEBUG] [core/backup_context.go:1561] [insertPath] [insertPath=files/insert_log/441111237232208082/441111237232208083/441224472928550688/]
[2023/05/05 09:04:25.909 +00:00] [DEBUG] [core/backup_context.go:1563] [fieldsLogDir] [fieldsLogDir="[]"]
[2023/05/05 09:04:25.911 +00:00] [WARN] [core/backup_context.go:538] ["this segment has no insert binlog"] [id=441224472928550688]
[2023/05/05 09:04:25.911 +00:00] [DEBUG] [core/backup_context.go:1561] [insertPath] [insertPath=files/insert_log/441111237232208082/441111237232208083/441224472928550690/]
[2023/05/05 09:04:25.912 +00:00] [DEBUG] [core/backup_context.go:1563] [fieldsLogDir] [fieldsLogDir="[]"]
[2023/05/05 09:04:25.914 +00:00] [WARN] [core/backup_context.go:538] ["this segment has no insert binlog"] [id=441224472928550690]
[2023/05/05 09:04:25.914 +00:00] [INFO] [core/backup_context.go:544] ["readSegmentInfo from storage"] [collectionName=tb_src_category] [segmentNum=4]
[2023/05/05 09:04:25.914 +00:00] [DEBUG] [core/backup_context.go:269] ["call refreshBackupMetaFunc"] [id=d58aefd7-eb23-11ed-83e5-0242ac1e0103]
[2023/05/05 09:04:25.914 +00:00] [INFO] [core/backup_context.go:576] ["finish build partition info"] [collectionName=tb_src_category] [partitionNum=1]
[2023/05/05 09:04:25.914 +00:00] [INFO] [core/backup_context.go:580] ["Begin copy data"] [collectionName=tb_src_category] [segmentNum=4]
[2023/05/05 09:04:25.914 +00:00] [INFO] [core/backup_context.go:610] ["partition size is smaller than MaxSegmentGroupSize, won't separate segments into groups in backup files"] [collectionId=441111237232208082] [partitionId=441111237232208083] [partitionSize=0] [MaxSegmentGroupSize=2147483648]
[2023/05/05 09:04:25.914 +00:00] [DEBUG] [core/backup_context.go:625] ["copy segment"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550532] [group_id=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:743] ["copy segment finished"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550532] [cost_time=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:625] ["copy segment"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550533] [group_id=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:743] ["copy segment finished"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550533] [cost_time=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:625] ["copy segment"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550688] [group_id=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:743] ["copy segment finished"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550688] [cost_time=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:625] ["copy segment"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550690] [group_id=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:743] ["copy segment finished"] [collection_id=441111237232208082] [partition_id=441111237232208083] [segment_id=441224472928550690] [cost_time=0]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:269] ["call refreshBackupMetaFunc"] [id=d58aefd7-eb23-11ed-83e5-0242ac1e0103]
[2023/05/05 09:04:25.915 +00:00] [DEBUG] [core/backup_context.go:269] ["call refreshBackupMetaFunc"] [id=d58aefd7-eb23-11ed-83e5-0242ac1e0103]
[2023/05/05 09:04:25.916 +00:00] [DEBUG] [core/backup_context.go:769] ["backup meta"] [value="{\"id\":\"d58aefd7-eb23-11ed-83e5-0242ac1e0103\",\"state_code\":2,\"start_time\":1683277465797,\"end_time\":1683277465915,\"name\":\"test_backup_110to122_debug\",\"backup_timestamp\":1683277465797,\"size\":0,\"milvus_version\":\"v2.2.4\"}"]
[2023/05/05 09:04:25.916 +00:00] [DEBUG] [core/backup_context.go:770] ["collection meta"] [value="{\"infos\":[{\"collection_id\":441111237232208082,\"collection_name\":\"tb_src_category\",\"schema\":{\"name\":\"tb_src_category\",\"description\":\"tb_src_category demo collection\",\"fields\":[{\"fieldID\":100,\"name\":\"key\",\"is_primary_key\":true,\"data_type\":21,\"type_params\":[{\"key\":\"max_length\",\"value\":\"32\"}]},{\"fieldID\":101,\"name\":\"shop_id\",\"data_type\":21,\"type_params\":[{\"key\":\"max_length\",\"value\":\"16\"}]},{\"fieldID\":102,\"name\":\"shop_name\",\"data_type\":21,\"type_params\":[{\"key\":\"max_length\",\"value\":\"32\"}]},{\"fieldID\":103,\"name\":\"cat_id\",\"data_type\":21,\"type_params\":[{\"key\":\"max_length\",\"value\":\"16\"}]},{\"fieldID\":104,\"name\":\"cat_name\",\"data_type\":21,\"type_params\":[{\"key\":\"max_length\",\"value\":\"1000\"}]},{\"fieldID\":105,\"name\":\"embedding\",\"data_type\":101,\"type_params\":[{\"key\":\"dim\",\"value\":\"1536\"}]}]},\"shards_num\":2,\"backup_timestamp\":441261087784960,\"size\":0,\"has_index\":false,\"index_infos\":[{\"field_name\":\"embedding\",\"index_name\":\"cid_idx\",\"index_type\":\"IVF_SQ8\",\"params\":{\"index_type\":\"IVF_SQ8\",\"metric_type\":\"IP\",\"params\":\"{\\\"nlist\\\":\\\"128\\\"}\"}}],\"load_state\":\"Loaded\",\"backup_physical_timestamp\":1683277465}]}"]
[2023/05/05 09:04:25.917 +00:00] [DEBUG] [core/backup_context.go:771] ["partition meta"] [value="{\"infos\":[{\"partition_id\":441111237232208083,\"partition_name\":\"_default\",\"collection_id\":441111237232208082,\"size\":0,\"load_state\":\"Loaded\"}]}"]
[2023/05/05 09:04:25.917 +00:00] [DEBUG] [core/backup_context.go:772] ["segment meta"] [value="{\"infos\":[{\"segment_id\":441224472928550532,\"collection_id\":441111237232208082,\"partition_id\":441111237232208083,\"num_of_rows\":33,\"deltalogs\":[{}],\"size\":0},{\"segment_id\":441224472928550533,\"collection_id\":441111237232208082,\"partition_id\":441111237232208083,\"num_of_rows\":29,\"deltalogs\":[{}],\"size\":0},{\"segment_id\":441224472928550688,\"collection_id\":441111237232208082,\"partition_id\":441111237232208083,\"num_of_rows\":5619,\"deltalogs\":[{}],\"size\":0},{\"segment_id\":441224472928550690,\"collection_id\":441111237232208082,\"partition_id\":441111237232208083,\"num_of_rows\":5481,\"deltalogs\":[{}],\"size\":0}]}"]
[2023/05/05 09:04:25.937 +00:00] [INFO] [core/backup_context.go:779] ["finish executeCreateBackup"] [requestId=d5894bde-eb23-11ed-83e5-0242ac1e0103] [backupName=test_backup_110to122_debug] [collections="[tb_src_category]"] [async=false] ["backup meta"="{\"id\":\"d58aefd7-eb23-11ed-83e5-0242ac1e0103\",\"state_code\":2,\"start_time\":1683277465797,\"end_time\":1683277465915,\"name\":\"test_backup_110to122_debug\",\"backup_timestamp\":1683277465797,\"size\":0,\"milvus_version\":\"v2.2.4\"}"]
[2023/05/05 09:04:25.937 +00:00] [DEBUG] [core/backup_context.go:269] ["call refreshBackupMetaFunc"] [id=d58aefd7-eb23-11ed-83e5-0242ac1e0103]
Success
 success